{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?7e02","webpack:///./src/components/Stage.vue?1d3a","webpack:///./src/components/Home.vue?8f3a","webpack:///./src/App.vue?bc83","webpack:///./src/components/Home.vue?9635","webpack:///./src/components/Stage.vue?f0da","webpack:///./src/components/Stage.vue","webpack:///./src/components/Stage.vue?091d","webpack:///./src/components/Stage.vue?d206","webpack:///./src/components/FacialExpression.vue?b1a0","webpack:///./src/components/FacialExpression.vue","webpack:///./src/components/FacialExpression.vue?1c1c","webpack:///./src/components/FacialExpression.vue?39c4","webpack:///./src/components/Home.vue","webpack:///./src/components/Home.vue?c731","webpack:///./src/components/Home.vue?2af2","webpack:///./src/App.vue","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/registerServiceWorker.ts","webpack:///./src/store/modules/FacialExpression.ts","webpack:///./src/store/index.ts","webpack:///./src/main.ts","webpack:///./src/components/FacialExpression.vue?d181"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","stageSize","width","height","scene","renderer","alpha","camera","light","loader","GLTFLoader","vrm1","vrm2","mixer1","mixer2","clock","console","log","$store","getters","facialExpression","setSize","size","setClearColor","position","set","normalize","add","posX","promise1","Promise","resolve","reject","loaderLoad","then","vrm","mixer","promise2","all","values","animate","stage","document","getElementById","style","appendChild","domElement","src","x","y","z","load","gltf","from","v","fetch","res","json","humanoid","setPose","progress","loaded","total","error","trackName","blendShapeProxy","getBlendShapeTrackName","BlendShapePresetName","Blink","blinkTrack","clip","action","clipAction","play","requestAnimationFrame","deltaTime","getDelta","update","blink_l","eyelid","blink_r","setValue","A","mouth","a","BlinkL","BlinkR","render","component","staticClass","on","clickCameraOn","_v","_m","MODEL_URI","containerEle","HTMLElement","cameraEle","HTMLVideoElement","overlayEle","HTMLCanvasElement","overlay","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceExpressionNet","srcObject","navigator","mediaDevices","getUserMedia","audio","video","stream","drawLoop","i1","i2","base","p1","p2","Math","abs","withFaceLandmarks","withFaceExpressions","detections","landmarks","landmarkOpenLv","getLeftEye","getRightEye","getMouth","dispatch","resizedDetections","getContext","clearRect","drawDetections","drawFaceLandmarks","drawFaceExpressions","innerWidth","innerHeight","components","Stage","FacialExpression","Home","ready","registered","cached","updatefound","updated","offline","index","_values","use","Store","state","mutations","setFacialExpression","payload","setValues","actions","doUpdateFacialExpression","commit","config","productionTip","store","h","$mount"],"mappings":"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","file":"js/app.94fa06ce.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=style&index=0&id=7c197518&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=style&index=0&id=7c197518&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=style&index=0&id=1626607c&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=style&index=0&id=1626607c&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('Home',{attrs:{\"msg\":\"Welcome to Your Vue.js + TypeScript App\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"home\"}},[_c('Stage',{attrs:{\"id\":\"stage\",\"size\":_vm.stageSize}}),_c('FacialExpression',{attrs:{\"id\":\"facial\",\"size\":{width: 640, height: 480}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"stage\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport { VRM, VRMSchema } from '@pixiv/three-vrm';\nimport * as THREE from 'three';\nimport { GLTFLoader, GLTF } from 'three/examples/jsm/loaders/GLTFLoader';\n\nimport { FacialExpressionInterface } from '../store/modules/FacialExpression';\n\n@Component\nexport default class Stage extends Vue {\n  @Prop() private size: any;\n  private scene = new THREE.Scene();\n  private renderer = new THREE.WebGLRenderer({ alpha: true });\n  private camera: THREE.PerspectiveCamera | null = null;\n  private light = new THREE.DirectionalLight(0xffffff);\n  private loader = new GLTFLoader();\n  private vrm1: VRM | null = null;\n  private vrm2: VRM | null = null;\n  private mixer1: THREE.AnimationMixer | null = null;\n  private mixer2: THREE.AnimationMixer | null = null;\n  private clock = new THREE.Clock();\n\n  private created() {\n    console.log('created', this);\n    console.log('store',this.$store);\n    console.log('facialExpression', this.$store.getters.facialExpression);\n  }\n\n  private mounted() {\n    // console.log('mounted');\n    this.renderer.setSize(this.size.width, this.size.height);\n    this.renderer.setClearColor( 0x000000, 0 );\n    this.camera = new THREE.PerspectiveCamera(20, this.size.width / this.size.height, 0.1, 1000);\n    this.camera.position.set(0,1.2,3);\n    this.light.position.set(1,1,1).normalize();\n    this.scene.add(this.light);\n    \n    const posX = 0.45;\n    const promise1 = new Promise((resolve, reject) => {\n      this.loaderLoad('/models/cecil-pink.vrm', posX*-1, 0, 0)\n        .then((result: any) => {\n          console.log('vrm1', result);\n          this.vrm1 = result.vrm;\n          this.mixer1 = result.mixer;\n          // this.prepareAnimation(this.vrm1!, this.mixer1!);\n          resolve(true);\n        });\n    });\n    const promise2 = new Promise((resolve, reject) => {\n      this.loaderLoad('/models/cecil-blue.vrm', posX, 0, 0)\n        .then((result: any) => {\n          console.log('vrm２', result);\n          this.vrm2 = result.vrm;\n          this.mixer2 = result.mixer;\n          // this.prepareAnimation(this.vrm2!, this.mixer2!);\n          resolve(true);\n        });\n    });\n    Promise.all([promise1, promise2]).then((values: any) => {\n      console.log('values', values);\n      console.log('vrm1', this.vrm1, this.mixer1);\n      console.log('vrm2', this.vrm2, this.mixer2);\n      // アニメーション実行\n      this.animate();\n    });\n\n    const stage: any = document.getElementById('stage');\n    if (stage !== null) {\n      stage.style.width = this.size.width;\n      stage.style.height = this.size.height;\n      stage.appendChild(this.renderer.domElement);\n    }\n  }\n\n  private loaderLoad(src: string, x: number, y: number, z: number){\n    return new Promise((resolve, reject) => {\n      this.loader.load(\n        src,\n        ( gltf ) => {\n          VRM.from( gltf ).then( ( v ) => {\n            const vrm = v;\n            // ポーズデータを読み込む\n            fetch( '/poses/pose.json' )\n              .then( ( res ) => res.json() )\n              .then( ( json ) => {\n                // ポーズ設定\n                vrm.humanoid!.setPose( json );\n\n                this.scene.add( vrm.scene );\n                vrm.scene.position.set(x, y, z);\n                \n                // VRMアニメーション設定\n                const mixer = new THREE.AnimationMixer( vrm.scene );\n                resolve({vrm: vrm, mixer: mixer});\n              } );\n          } );\n        },\n        ( progress ) => {\n          console.log( 'Loading model...', 100.0 * ( progress.loaded / progress.total ), '%' );\n        },\n        ( error ) => {\n          console.error( error );\n        }\n      );\n    });\n  }\n\n  private prepareAnimation(vrm: VRM, mixer: THREE.AnimationMixer) {\n    // ウインクさせてみる\n    const trackName = vrm.blendShapeProxy!.getBlendShapeTrackName( VRMSchema.BlendShapePresetName.Blink );\n    // console.log(\"trackName\", trackName);\n    const blinkTrack = new THREE.NumberKeyframeTrack(\n        trackName!, // name\n        [ 0.0, 0.5, 1.0 ], // times\n        [ 0.0, 1.0, 0.0 ] // values\n      );\n    const clip = new THREE.AnimationClip( 'blink', 1.0, [ blinkTrack ] );\n    const action = mixer.clipAction( clip );\n    action.play();    \n  }\n\n  // アニメーション\n  private animate() {\n    requestAnimationFrame(this.animate);    \n    const deltaTime = this.clock.getDelta();\n    if (this.vrm1 !== null && this.mixer1 !== null){\n      // this.vrm1.scene.rotation.y = Math.PI * Math.sin( this.clock.getElapsedTime() );\n      this.vrm1.update( deltaTime );\n      this.mixer1.update( deltaTime );\n\n      const values: FacialExpressionInterface = this.$store.getters.facialExpression;\n      if (this.vrm1.blendShapeProxy){\n        const blink_l =  (0.9 < values.eyelid.blink_l)? 0.0 : values.eyelid.blink_l;\n        const blink_r =  (0.9 < values.eyelid.blink_r)? 0.0 : values.eyelid.blink_r;\n        // 表情の反映\n        this.vrm1.blendShapeProxy.setValue( VRMSchema.BlendShapePresetName.A, values.mouth.a );\n        this.vrm1.blendShapeProxy.setValue( VRMSchema.BlendShapePresetName.BlinkL, blink_l );\n        this.vrm1.blendShapeProxy.setValue( VRMSchema.BlendShapePresetName.BlinkR, blink_r );\n      }\n    }\n    if (this.vrm2 !== null && this.mixer2 !== null){\n      this.vrm2.update( deltaTime );\n      this.mixer2.update( deltaTime );\n      \n      const values: FacialExpressionInterface = this.$store.getters.facialExpression;\n      if (this.vrm2.blendShapeProxy){\n        const blink_l =  (0.9 < values.eyelid.blink_l)? 0.0 : values.eyelid.blink_l;\n        const blink_r =  (0.9 < values.eyelid.blink_r)? 0.0 : values.eyelid.blink_r;\n        // 表情の反映\n        this.vrm2.blendShapeProxy.setValue( VRMSchema.BlendShapePresetName.A, values.mouth.a );\n        this.vrm2.blendShapeProxy.setValue( VRMSchema.BlendShapePresetName.BlinkL, blink_l );\n        this.vrm2.blendShapeProxy.setValue( VRMSchema.BlendShapePresetName.BlinkR, blink_r );\n      }\n    }\n    this.renderer.render(this.scene, this.camera!);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Stage.vue?vue&type=template&id=7c197518&scoped=true&\"\nimport script from \"./Stage.vue?vue&type=script&lang=ts&\"\nexport * from \"./Stage.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Stage.vue?vue&type=style&index=0&id=7c197518&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7c197518\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"facial-expression\"},[_c('button',{on:{\"click\":_vm.clickCameraOn}},[_vm._v(\"カメラON\")]),_vm._m(0)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"facial-container\"}},[_c('video',{attrs:{\"id\":\"facial-camera\",\"playsinline\":\"\",\"autoplay\":\"\"}}),_c('canvas',{attrs:{\"id\":\"facial-overlay\"}})])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport * as faceapi from 'face-api.js';\n\nimport { FacialExpressionInterface } from '../store/modules/FacialExpression';\n\n@Component\nexport default class FacialExpression  extends Vue {\n  @Prop() private size: any;\n\n  private camera!: HTMLVideoElement;\n  private overlay!: HTMLCanvasElement;\n  \n  // モデル\n  private MODEL_URI = '/face/weights';\n\n  private created() {\n    console.log('created', this.size);\n    // console.log('faceapi', faceapi.nets)\n    console.log('store',this.$store);\n    console.log('facialExpression', this.$store.getters.facialExpression);\n  }\n\n  private mounted() {\n    const containerEle = document.getElementById('facial-container');\n    if (!(containerEle instanceof HTMLElement)) {\n      console.error('containerEle not an HTMLElement', containerEle)\n      return\n    }\n\n    const cameraEle = document.getElementById('facial-camera');\n    if (!(cameraEle instanceof HTMLVideoElement)) {\n      console.error('cameraEle not an HTMLVideoElement')\n      return\n    }\n    this.camera = cameraEle;\n\n    const overlayEle = document.getElementById('facial-overlay');\n    if (!(overlayEle instanceof HTMLCanvasElement)) {\n      console.error('overlayEle not an HTMLCanvasElement')\n      return\n    }\n    this.overlay = overlayEle;\n\n    containerEle.style.width = `${this.size.width}px`;\n    containerEle.style.height = `${this.size.height}px`;\n\n    this.camera.width = this.size.width;\n    this.camera.height = this.size.height;\n\n    this.overlay.width = this.size.width;\n    this.overlay.height = this.size.height;\n    \n    // モデルをロードする\n    Promise.all([\n      // 顔認識\n      faceapi.nets.tinyFaceDetector.loadFromUri(this.MODEL_URI),\n      // 顔パーツの位置\n      faceapi.nets.faceLandmark68Net.loadFromUri(this.MODEL_URI),\n      // 表情スコア\n      faceapi.nets.faceExpressionNet.loadFromUri(this.MODEL_URI),\n    ])\n    .then(() => {\n      console.log('load MODEL_URI');\n    });\n  }\n\n  // カメラを有効にする\n  private clickCameraOn() {\n    console.log('clickCameraOn',this.camera.srcObject);\n    if (this.camera.srcObject) {\n      console.log('stop');\n    }else{\n      navigator.mediaDevices.getUserMedia(\n          { audio: false,\n            video: true,\n            /* video: { width: this.size.width, height: this.size.height }, */\n          })\n          .then((stream) => {\n          // console.log('stream',stream);\n          if (this.camera !== null) {\n            this.camera.srcObject = stream;\n\n            this.drawLoop();\n          }\n        });\n    }\n  }\n\n  // 目,口の開閉 0.0 - 1.0\n  private landmarkOpenLv(p:faceapi.Point[], i1: number, i2: number, base: number): number {\n    const p1 = p[i1].y;\n    const p2 = p[i2].y;\n    // console.log('v', Math.abs(p1 - p2));\n    const v = ( Math.abs(p1 - p2) / base);\n    return (v > 1.0) ? 1.0 : v;\n  }\n\n  private async drawLoop() {\n    requestAnimationFrame(this.drawLoop);\n    if (this.overlay !== null && this.camera !== null) {\n      // console.log('overlayCC');\n      // オーバーレイ 表示\n\n      // 1人 顔データ取得 顔パーツ,表情\n      const detections = await faceapi.detectSingleFace(\n                              this.camera,\n                              new faceapi.TinyFaceDetectorOptions()\n                          ).withFaceLandmarks()\n                          .withFaceExpressions();\n      if(typeof detections === 'undefined'){\n        return;\n      }\n\n      // console.log('detections', detections);\n      // const expressions = detections.expressions;\n      // console.log('expressions', expressions);\n      /*\n      angry: 0.002782773692160845\n      disgusted: 0.000007903956429800019\n      fearful: 4.904609909317514e-7\n      happy: 0.00007700323476456106\n      neutral: 0.9826717376708984\n      sad: 0.014413285069167614\n      surprised: 0.00004698477277997881\n      */\n\n      const landmarks: faceapi.FaceLandmarks68 = detections.landmarks;\n      // console.log('landmarks', landmarks);\n      // Points 0 - 67\n      // leftEye 37 - 42   38,41 ,5 \n      // rightEye 43 - 48  44,48 ,5\n      // mouth   49 - 67  63,67, 18\n\n      const src:FacialExpressionInterface = this.$store.getters.facialExpression;\n      src.eyelid.blink_l = this.landmarkOpenLv(landmarks.getLeftEye(), 1, 4, 10.0);\n      src.eyelid.blink_r = this.landmarkOpenLv(landmarks.getRightEye(), 2, 5, 10.0);\n      src.mouth.a = this.landmarkOpenLv(landmarks.getMouth(), 15, 19, 25.0);\n      // console.log('leftEye', src.eyelid.blink_l);\n      // console.log('rightEye', src.eyelid.blink_r);\n      // console.log('mouth', src.mouth.a);\n      this.$store.dispatch('doUpdateFacialExpression', src);\n\n      /*\n      const jawOutline = landmarks.getJawOutline()\n      const nose = landmarks.getNose()\n      const mouth = landmarks.getMouth(); // 15,19\n      const leftEye = landmarks.getLeftEye() // 2,4\n      const rightEye = landmarks.getRightEye() // 1,5\n      const leftEyeBbrow = landmarks.getLeftEyeBrow()\n      const rightEyeBrow = landmarks.getRightEyeBrow()\n      */\n\n      // console.log('camera', this.camera.width, this.camera.height);\n      // console.log('overlay', this.overlay);\n      // リサイズ\n      const resizedDetections = faceapi.resizeResults(detections, {\n                        width: this.size.width,\n                        height: this.size.height });\n      \n      this.overlay.getContext('2d')!.clearRect(0, 0, this.size.width, this.size.height);\n      // 顔の位置\n      faceapi.draw.drawDetections(this.overlay, resizedDetections);\n      // 顔のパーツ\n      faceapi.draw.drawFaceLandmarks(this.overlay, resizedDetections);\n      // 表情    \n      faceapi.draw.drawFaceExpressions(this.overlay, resizedDetections); \n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FacialExpression.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FacialExpression.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FacialExpression.vue?vue&type=template&id=91dc579e&scoped=true&\"\nimport script from \"./FacialExpression.vue?vue&type=script&lang=ts&\"\nexport * from \"./FacialExpression.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FacialExpression.vue?vue&type=style&index=0&id=91dc579e&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"91dc579e\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport Stage from './Stage.vue';\nimport FacialExpression from './FacialExpression.vue';\n\n@Component({\n  components: {\n    Stage,\n    FacialExpression,\n  },\n})\nexport default class Home extends Vue {\n  private stageSize = {width: window.innerWidth, height: window.innerHeight};  \n  private created() {\n    console.log('created');\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Home.vue?vue&type=template&id=1626607c&scoped=true&\"\nimport script from \"./Home.vue?vue&type=script&lang=ts&\"\nexport * from \"./Home.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Home.vue?vue&type=style&index=0&id=1626607c&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1626607c\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport Home from './components/Home.vue';\n\n@Component({\n  components: {\n    Home,\n  },\n})\nexport default class App extends Vue {}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=f5c55202&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/* eslint-disable no-console */\n\nimport { register } from 'register-service-worker'\n\nif (process.env.NODE_ENV === 'production') {\n  register(`${process.env.BASE_URL}service-worker.js`, {\n    ready () {\n      console.log(\n        'App is being served from cache by a service worker.\\n' +\n        'For more details, visit https://goo.gl/AFskqB'\n      )\n    },\n    registered () {\n      console.log('Service worker has been registered.')\n    },\n    cached () {\n      console.log('Content has been cached for offline use.')\n    },\n    updatefound () {\n      console.log('New content is downloading.')\n    },\n    updated () {\n      console.log('New content is available; please refresh.')\n    },\n    offline () {\n      console.log('No internet connection found. App is running in offline mode.')\n    },\n    error (error) {\n      console.error('Error during service worker registration:', error)\n    }\n  })\n}\n","export interface FacialExpressionInterface {\n    'index': number,\n    'mouth': {\n        'a': number,\n        'i': number,\n        'u': number,\n        'e': number,\n        'o': number,\n    },\n    'eyelid': {\n        'blink_l': number,\n        'blink_r': number,\n        'blink': number,\n    },\n    'look': {\n        'lookdown': number,\n        'lookup': number,\n        'lookleft': number,\n        'lookright': number,\n    },\n    'emotion':{\n        'angry': number,\n        'fun': number,\n        'joy': number,\n        'neutral': number,\n        'sorrow': number,\n        'unknown': number,\n    }\n}\n\nexport class FacialExpression {\n    // value 0.0 - 1.0\n    private _values: FacialExpressionInterface = {\n        'index': 0,\n        'mouth': {\n            'a': 0.0,\n            'i': 0.0,\n            'u': 0.0,\n            'e': 0.0,\n            'o': 0.0,\n        },\n        'eyelid': {\n            'blink_l': 0.0,\n            'blink_r': 0.0,\n            'blink': 0.0,\n        },\n        'look': {\n            'lookdown': 0.0,\n            'lookup': 0.0,\n            'lookleft': 0.0,\n            'lookright': 0.0,\n        },\n        'emotion':{\n            'angry': 0.0,\n            'fun': 0.0,\n            'joy': 0.0,\n            'neutral': 0.0,\n            'sorrow': 0.0,\n            'unknown': 0.0,\n        }\n    }\n\n    constructor(index: number){\n        this._values.index = index;\n    }\n\n    public setValues(src: FacialExpressionInterface) {\n        this._values = src;\n    }\n\n    public get values(): FacialExpressionInterface {\n        return this._values;\n    }\n}","import Vue from 'vue';\nimport Vuex from 'vuex';\nVue.use(Vuex)\n\nimport { FacialExpression } from './modules/FacialExpression';\n\nexport default new Vuex.Store({\n  state: {\n    facialExpression: new FacialExpression(0),\n  },\n  mutations: {\n    setFacialExpression(state,payload){\n      state.facialExpression.setValues(payload.src);\n    }\n  },\n  actions: {\n    doUpdateFacialExpression: ({commit}, src) => {\n      commit('setFacialExpression',{src});\n    }\n  },\n  getters: {\n    facialExpression: (state) => {\n      return state.facialExpression.values;\n    }\n  },\n  modules: {\n\n  }\n})\n","import Vue from 'vue'\nimport App from './App.vue'\nimport './registerServiceWorker'\nimport store from './store'\n\nVue.config.productionTip = false\n\nnew Vue({\n  store,\n  render: h => h(App)\n}).$mount('#app')\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FacialExpression.vue?vue&type=style&index=0&id=91dc579e&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FacialExpression.vue?vue&type=style&index=0&id=91dc579e&scoped=true&lang=scss&\""],"sourceRoot":""}